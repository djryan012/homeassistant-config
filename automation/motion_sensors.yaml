 ##### Garage Lights
- alias: "Turn on off garage lights when there is movement"
  initial_state: True
  trigger:
    - platform: state
      entity_id: binary_sensor.garage_motion_status
      to: 'on'
    - platform: state
      entity_id: binary_sensor.garage_motion_status
      to: 'off'
      for:
        minutes: 20
  action:
    - service_template: '{% if trigger.to_state.state == "on" %}switch.turn_on{% elif trigger.to_state.state == "off" %}switch.turn_off{% endif %}'
      entity_id: group.garage

# #####  Turn Side light on/off with motion  #####
# - alias: "Side Light on by Sensor"
#   initial_state: True
#   trigger:
#     - platform: state
#       entity_id: binary_sensor.gate_motion_status
#       to: 'on'
#     - platform: state
#       entity_id: binary_sensor.gate_motion_status
#       to: 'off'
#       for:
#         minutes: 5
#   action:
#     - service_template: >
#         script.side_light_{{ 'on' if is_state('light.test','on') else 'off' }}

####  Turn Side light on with motion  #####
- alias: "Side Light on by Sensor"
  initial_state: True
  trigger:
    - platform: state
      entity_id: binary_sensor.gate_motion_status
      to: 'on'
  action:
    - service: script.side_light_on
    
- alias: "Side Light off by Sensor"
  initial_state: True
  trigger:
    - platform: state
      entity_id: binary_sensor.gate_motion_status
      to: 'off'
  action:
    - service: script.side_light_off


#####  Turn Patio light on with motion  #####
- alias: "Patio Light on by camera sensor"
  initial_state: True
  trigger:
    - platform: state
      entity_id: binary_sensor.blueiris_back_yard_motion
      from: 'off'
      to: 'on'
  condition:
      condition: and  # 'when dark' condition: either after sunset or before sunrise
      conditions:
        - condition: sun
          after: sunset
        - condition: sun
          before: sunrise
        - condition: state
          entity_id: light.patio_lights
          state: 'off'
          # optional: trigger only if state was this for last X time.
          for:
             seconds: 15
        - condition: state
          entity_id: light.patio_lights
          state: 'on'
  action:
    - service: homeassistant.turn_on
      entity_id: light.patio_lights
      data:
        brightness: 150
        transition: 0

# Lights out no motion detected
- alias: "Dinning Light out"
  initial_state: True
  trigger:
    - platform: state
      entity_id: binary_sensor.echo_occupancy
      to: 'off'
  action:
    - service: homeassistant.turn_off
      entity_id:
        -  group.dinning_room


####  Wetbar Control with motion  #####
- alias: "Wetbar on by Sensor"
  initial_state: True
  trigger:
    - platform: state
      entity_id: binary_sensor.tradfri_motion_sensor
      to: 'on'
  action:
    - service: script.wetbar_on
- alias: "Wetbar off by Sensor"
  initial_state: True
  trigger:
    - platform: state
      entity_id: binary_sensor.tradfri_motion_sensor
      to: 'off'
  action:
    - service: script.wetbar_off
